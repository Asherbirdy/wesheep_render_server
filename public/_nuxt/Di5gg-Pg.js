import{_ as R,a as q}from"./BO9AxJ9e.js";import{U as T,e as B,r as P,g as f,h as $,c as j,o as F,b as n,w as c,a as l,t as i,i as a,j as O}from"./CjRUKRZB.js";import{_ as I,a as N,b as S}from"./BSB76UDz.js";import{u as x}from"./DIW7IX5B.js";import{u as z}from"./BlDQ19ZQ.js";import"./BqceN3w-.js";import"./8h7uWm59.js";import"./Br5zpwwZ.js";const D={showMe:async()=>z(T.UserShowMe,{method:"GET",server:!1,lazy:!0})},G={class:"flex flex-col justify-between gap-4 h-full"},H={class:""},te=B({__name:"index",async setup(J){let t,s;const e=P({data:{emailVerifiedModal:{otp:""}},feature:{emailCountdown:{status:!1,time:60,countdown:0}}}),{data:u}=([t,s]=f(()=>D.showMe()),t=await t,s(),t),{execute:C}=([t,s]=f(()=>x.sendOTP()),t=await t,s(),t),{execute:U}=([t,s]=f(()=>x.bindOTPEmail({OTP:e.value.data.emailVerifiedModal.otp})),t=await t,s(),t),V=async()=>{const{emailCountdown:o}=e.value.feature;await C(),o.status=!0,o.countdown=o.time},v=async()=>{await U()};$(e.value.feature.emailCountdown,o=>{if(o.countdown>0){setTimeout(()=>{e.value.feature.emailCountdown.countdown--},1e3);return}e.value.feature.emailCountdown.status=!1,e.value.feature.emailCountdown.countdown=e.value.feature.emailCountdown.time});const y=o=>{const r=[];return o.otp||r.push({name:"otp",message:"驗證碼不能為空"}),r};return(o,r)=>{const E=R,_=O,M=S,g=N,k=I,A=q;return F(),j("div",G,[n(E,null,{default:c(()=>{var m,d,p,w,b,h;return[l("h2",null,"姓名："+i((m=a(u))==null?void 0:m.user.name),1),l("h2",null,"電子信箱："+i((d=a(u))==null?void 0:d.user.email),1),l("h2",null,"區域："+i((p=a(u))==null?void 0:p.user.district.name),1),l("h2",null,"Email驗證："+i((w=a(u))==null?void 0:w.user.emailVerified),1),l("h2",null,"權限："+i((b=a(u))==null?void 0:b.user.role),1),l("h2",null,"網頁權限："+i((h=a(u))==null?void 0:h.user.landingPageAccess),1)]}),_:1}),n(A,{dismissible:!1,title:"Email驗證"},{body:c(()=>{var m;return[n(k,{state:(m=a(e).data)==null?void 0:m.emailVerifiedModal,validate:y},{default:c(()=>[l("div",H,[n(g,{label:"驗證碼",name:"otp",class:"flex-1 justify-between w-full gap-4 mb-2"},{default:c(()=>[n(M,{modelValue:a(e).data.emailVerifiedModal.otp,"onUpdate:modelValue":r[0]||(r[0]=d=>a(e).data.emailVerifiedModal.otp=d),label:"驗證碼",class:"flex-1 w-[calc(100%-124px)] mr-1",placeholder:"請輸入驗證碼"},null,8,["modelValue"]),n(_,{disabled:a(e).feature.emailCountdown.status,label:a(e).feature.emailCountdown.status?`${a(e).feature.emailCountdown.countdown}秒`:"寄送 Email 驗證",variant:"soft",class:"inline-block",onClick:V},null,8,["disabled","label"])]),_:1})])]),_:1},8,["state"]),n(_,{label:"驗證 Email",block:"",onClick:v})]}),default:c(()=>[n(_,{label:"Email 驗證",block:""})]),_:1})])}}});export{te as default};
