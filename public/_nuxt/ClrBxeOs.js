import{U as h}from"./Ca4tM4z1.js";import{_ as k,a as q}from"./1tTMQe0L.js";import{ai as i,aj as B,e as D,v as $,ag as A,c as N,o as S,b as n,ah as R,l as t,w as r,d as T,ac as j,a as s,q as O,F as z,t as _,r as P,j as L}from"./CJ1hmjfG.js";import{u as f}from"./CGG-KMyI.js";import{_ as M}from"./BUptX5Lb.js";import{a as H,b as J,_ as K}from"./CTniawRl.js";import{u as Q,r as E}from"./wnGBfK5N.js";import{R as V,r as W}from"./yGGtjXql.js";import"./DoQgW4XQ.js";import"./D4vmFw8Y.js";import"./Dccidqh2.js";import"./CNAs7NbN.js";import"./B9xwmjdC.js";import"./B3fnfiUs.js";const X={getAll:async()=>{const l=B();return await f(i.District,{method:"GET",server:!1,lazy:!0,key:i.District,getCachedData:a=>l.payload.data[a]||l.static.data[a]})},create:async l=>await f(i.District,{method:"POST",server:!1,lazy:!0,body:l}),edit:async l=>await f(i.District,{method:"PUT",server:!1,lazy:!0,body:l})},I={getAll:async()=>{const l=B();return await f(i.SerialNumberGetAll,{method:"GET",server:!1,key:i.SerialNumberGetAll,getCachedData:a=>l.payload.data[a]||l.static.data[a]})},create:async l=>await f(i.SerialNumberCreate,{method:"POST",server:!1,lazy:!0,immediate:!1,watch:!1,body:l}),delete:async l=>await f(i.SerialNumberDelete,{method:"DELETE",server:!1,lazy:!0,immediate:!1,watch:!1,body:l})},Y={class:"flex gap-4"},Z=D({__name:"AddSerialNumberComponent",async setup(l){let a,d;const o=$({data:{role:V.user,districtId:"",notes:""},feature:{modal:{open:!1}}}),{execute:b,status:u}=([a,d]=A(()=>I.create(o.value.data)),a=await a,d(),a),{data:y}=Q(i.District),v=async()=>{const{feature:c,data:e}=o.value;await b(),await E(i.SerialNumberGetAll),c.modal.open=!1,e.role=V.user,e.districtId="",e.notes=""};return(c,e)=>{const p=j,x=R,U=M,g=J,w=K,G=H,F=k;return S(),N("div",null,[n(x,{onClick:e[0]||(e[0]=m=>t(o).feature.modal.open=!0)},{default:r(()=>[n(p,{name:"i-lucide-plus"}),e[6]||(e[6]=T(" 創建序號 "))]),_:1}),n(F,{open:t(o).feature.modal.open,"onUpdate:open":e[5]||(e[5]=m=>t(o).feature.modal.open=m),title:"創建序號",ui:{footer:"justify-end"}},{body:r(()=>[n(G,{state:t(o).data,class:"space-y-4 flex flex-col gap-4"},{default:r(()=>[s("div",Y,[n(g,{label:"角色",name:"role"},{default:r(()=>[n(U,{modelValue:t(o).data.role,"onUpdate:modelValue":e[1]||(e[1]=m=>t(o).data.role=m),items:t(W),label:"角色",name:"role"},null,8,["modelValue","items"])]),_:1}),n(g,{label:"區域",name:"districtId"},{default:r(()=>{var m;return[n(U,{modelValue:t(o).data.districtId,"onUpdate:modelValue":e[2]||(e[2]=C=>t(o).data.districtId=C),label:"區域",name:"districtId",items:(m=t(y))==null?void 0:m.districts.map(C=>({label:C.name,value:C._id}))},null,8,["modelValue","items"])]}),_:1})]),n(g,{label:"備註",name:"notes"},{default:r(()=>[n(w,{modelValue:t(o).data.notes,"onUpdate:modelValue":e[3]||(e[3]=m=>t(o).data.notes=m),label:"備註",name:"notes",ui:{root:"w-full"}},null,8,["modelValue"])]),_:1})]),_:1},8,["state"])]),footer:r(()=>[n(x,{label:"取消",color:"neutral",variant:"outline",onClick:e[4]||(e[4]=m=>t(o).feature.modal.open=!1)}),n(x,{label:"確認",variant:"outline",disabled:!t(o).data.role||!t(o).data.districtId||!t(o).data.notes,loading:t(u)==="pending",onClick:v},null,8,["disabled","loading"])]),_:1},8,["open"])])}}}),ee=D({__name:"DeleteSerialNumberComponent",props:{serialNumberId:{}},async setup(l){let a,d;const o=l,{serialNumberId:b}=O(o),u=$({feature:{modal:{open:!1}},data:null}),{execute:y,status:v}=([a,d]=A(()=>I.delete({id:b.value})),a=await a,d(),a),c=async()=>{await y(),await E(i.SerialNumberGetAll),u.value.feature.modal.open=!1};return(e,p)=>{const x=j,U=R,g=k;return S(),N(z,null,[s("div",null,[n(x,{name:"i-lucide-trash",class:"size-5",onClick:p[0]||(p[0]=w=>t(u).feature.modal.open=!0)})]),n(g,{open:t(u).feature.modal.open,"onUpdate:open":p[2]||(p[2]=w=>t(u).feature.modal.open=w),title:"刪除序號",ui:{footer:"justify-end"}},{body:r(()=>[s("p",null,_(`是否刪除序號 ${t(b)}`),1)]),footer:r(()=>[n(U,{label:"取消",color:"neutral",variant:"outline",onClick:p[1]||(p[1]=w=>t(u).feature.modal.open=!1)}),n(U,{label:"確認",variant:"outline",loading:t(v)==="pending",onClick:c},null,8,["loading"])]),_:1},8,["open"])],64)}}}),te={class:"flex items-center gap-2 justify-between mb-4"},ae={class:"flex items-center gap-2 justify-between"},oe={class:"flex items-center gap-2"},ve=D({__name:"serialNumber",async setup(l){let a,d;const{data:o}=([a,d]=A(()=>I.getAll()),a=await a,d(),a);return[a,d]=A(()=>X.getAll()),await a,d(),(b,u)=>{var c;const y=h,v=q;return S(),N("div",null,[s("div",te,[u[0]||(u[0]=s("p",{class:"text-md font-bold"}," 序號列表 ",-1)),n(t(Z))]),(S(!0),N(z,null,P((c=t(o))==null?void 0:c.userSerialNumber,e=>(S(),L(v,{key:e._id,class:"mb-4"},{header:r(()=>[s("div",ae,[s("div",oe,[n(y,{color:e.isUsed?"success":"warning",variant:"outline"},{default:r(()=>[T(_(e.isUsed?"已使用":"未使用"),1)]),_:2},1032,["color"]),s("p",null,_(e.notes||"無備註"),1)]),n(t(ee),{"serial-number-id":e._id},null,8,["serial-number-id"])])]),default:r(()=>[s("p",null,"序號："+_(e.serialNumber),1),s("p",null,"角色："+_(e.role),1),s("p",null,"區："+_(e.districtId.name),1),s("p",null,"創建時間："+_(e.createdAt),1)]),_:2},1024))),128))])}}});export{ve as default};
